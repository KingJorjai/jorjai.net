"use strict";(globalThis.webpackChunkctf_writeups=globalThis.webpackChunkctf_writeups||[]).push([[142],{923:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/resultado1-3158c62ddb9946ac2e749ea984887135.png"},2321:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/files/yellow_card-574a38707683ed277f65c5ac500dc096.png"},2854:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/oraculo-landing-63b0bc7169c3e6dfebff04606262c244.png"},5597:(e,a,n)=>{n.d(a,{A:()=>i});const i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAR4AAADIAQMAAAAEFxwTAAAAA1BMVEUA/wA0XsCoAAAAHklEQVRYw+3BAQ0AAADCoPdPbQ43oAAAAAAAAAC+DBzoAAG6qV/tAAAAAElFTkSuQmCC"},5888:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/resultado2-15cc2c6af56c7e43a70ccb2b35dd2fee.png"},7769:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/hue-shift-ae8ee542ec4ee4b41de571b1cb338d4e.gif"},8453:(e,a,n)=>{n.d(a,{R:()=>r,x:()=>l});var i=n(6540);const s={},o=i.createContext(s);function r(e){const a=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function l(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:a},e.children)}},8857:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"ikerlan-ctf/400/el-oraculo-cegado/el-oraculo-cegado","title":"El or\xe1culo cegado (400)","description":"El sistema de seguridad de MegaCorp usa un clasificador de im\xe1genes para controlar el acceso. Solo permite entrar si detectas que llevas una \\"tarjeta de acceso verde\\". Tienes una imagen de una tarjeta Amarilla (acceso denegado), pero has descubierto que el clasificador tiene una vulnerabilidad.","source":"@site/docs/ikerlan-ctf/400/el-oraculo-cegado/el-oraculo-cegado.mdx","sourceDirName":"ikerlan-ctf/400/el-oraculo-cegado","slug":"/ikerlan-ctf/400/el-oraculo-cegado/","permalink":"/docs/ikerlan-ctf/400/el-oraculo-cegado/","draft":false,"unlisted":false,"editUrl":"https://github.com/KingJorjai/jorjai.net/tree/main/packages/create-docusaurus/templates/shared/docs/ikerlan-ctf/400/el-oraculo-cegado/el-oraculo-cegado.mdx","tags":[],"version":"current","frontMatter":{"title":"El or\xe1culo cegado (400)"},"sidebar":"ctfWriteupsSidebar","previous":{"title":"El espectro oculto (400)","permalink":"/docs/ikerlan-ctf/400/el-espectro-oculto/"},"next":{"title":"L\xf3gica doble valor (400)","permalink":"/docs/ikerlan-ctf/400/logica-doble-valor/"}}');var s=n(4848),o=n(8453);const r={title:"El or\xe1culo cegado (400)"},l=void 0,c={},d=[{value:"An\xe1lisis inicial",id:"an\xe1lisis-inicial",level:2},{value:"Ataque",id:"ataque",level:2}];function t(e){const a={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.p,{children:'El sistema de seguridad de MegaCorp usa un clasificador de im\xe1genes para controlar el acceso. Solo permite entrar si detectas que llevas una "tarjeta de acceso verde". Tienes una imagen de una tarjeta Amarilla (acceso denegado), pero has descubierto que el clasificador tiene una vulnerabilidad.'}),"\n",(0,s.jsx)(a.p,{children:"\xbfPodr\xe1s enga\xf1ar al clasificador?"}),"\n",(0,s.jsxs)(a.p,{children:[(0,s.jsx)(a.img,{alt:"P\xe1gina principal",src:n(2854).A+"",width:"1920",height:"1134"}),"\n",(0,s.jsx)(a.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(2321).A+"",children:"Descargar Tarjeta Amarilla"})]}),"\n",(0,s.jsx)(a.h2,{id:"an\xe1lisis-inicial",children:"An\xe1lisis inicial"}),"\n",(0,s.jsx)(a.p,{children:"Parece que tenemos que usar una tarjeta de acceso de color verde para que nos den acceso a la p\xe1gina. Vamos a ver que pasa si subo una imagen completamente verde que he encontrado por ah\xed."}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.img,{alt:"Tarjeta verde",src:n(5597).A+"",width:"286",height:"200"})}),"\n",(0,s.jsx)(a.p,{children:"Obtenemos el siguiente resultado del clasificador:"}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.img,{alt:"Resultados del primer an\xe1lisis",src:n(923).A+"",width:"1920",height:"1134"})}),"\n",(0,s.jsx)(a.p,{children:"Lo pongo en texto para que se vea mejor:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:"Decisi\xf3n: GREEN\n\nConfianza: 99.0%\n\nRaz\xf3n: Green channel leads by 255.0\n\nAcceso: CONCEDIDO\n"})}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:"Estad\xedsticas RGB:\n\nPromedio Rojo: 0.00\n\nPromedio Verde: 255.00\n\nPromedio Azul: 0.00\n\nVentaja Verde: 255.00\n"})}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:'Verificaci\xf3n Adversarial:\n\n{ "fail_reason": "Too many pixels modified", "max_allowed_modification": "25%", "modified_percentage": "100.0%" }\n'})}),"\n",(0,s.jsx)(a.p,{children:"Se ve que el clasificador se basa en el canal verde de la imagen, y si este es el m\xe1s alto, nos concede acceso. Adem\xe1s, parece que tiene una verificaci\xf3n adversarial que impide que modifiquemos m\xe1s del 25% de los p\xedxeles de la imagen."}),"\n",(0,s.jsx)(a.h2,{id:"ataque",children:"Ataque"}),"\n",(0,s.jsx)(a.p,{children:"Lo m\xe1s sensato ser\xeda hacer alg\xfan script que modifique la imagen amarilla para que el canal verde sea el m\xe1s alto, pero sin modificar m\xe1s del 25% de los p\xedxeles. En mi caso, estaba en juego conseguir una first blood, as\xed que opt\xe9 por un enfoque m\xe1s manual."}),"\n",(0,s.jsx)(a.admonition,{type:"tip",children:(0,s.jsx)(a.p,{children:"Un enfoque m\xe1s automatizado podr\xeda implicar iterar sobre los p\xedxeles de la imagen amarilla y aumentar selectivamente el valor del canal verde en un subconjunto de p\xedxeles hasta que el promedio del canal verde supere al del canal rojo, asegur\xe1ndose de no modificar m\xe1s del 25% de los p\xedxeles."})}),"\n",(0,s.jsx)(a.p,{children:"Abr\xed la imagen amarilla en un editor de im\xe1genes (GIMP en mi caso) y desde Colours -> Hue-Saturation, cambi\xe9 el color a ojo hasta que me pareci\xf3 que la tarjeta era m\xe1s verde que amarilla, aunque segu\xeda teniendo un tono amarillento."}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.img,{alt:"GIF del proceso de edici\xf3n",src:n(7769).A+"",width:"800",height:"472"})}),"\n",(0,s.jsx)(a.p,{children:"Tuve la suerte de que el cambio de color no modificaba m\xe1s del 25% de los p\xedxeles, y al subir la imagen modificada al clasificador, obtuve el siguiente resultado:"}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.img,{alt:"Resultados del segundo an\xe1lisis",src:n(5888).A+"",width:"1920",height:"1134"})}),"\n",(0,s.jsx)(a.p,{children:"En texto:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:"Decisi\xf3n: GREEN\n\nConfianza: 97.6%\n\nRaz\xf3n: Green channel leads by 18.8\n\nAcceso: CONCEDIDO\n"})}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:"Estad\xedsticas RGB:\n\nPromedio Rojo: 172.81\n\nPromedio Verde: 191.63\n\nPromedio Azul: 74.03\n\nVentaja Verde: 18.82\n"})}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:'Verificaci\xf3n Adversarial:\n\n{ "avg_red": "172.8", "max_allowed_modification": "25%", "min_red_required": "160", "modified_percentage": "21.6%", "success": "All constraints satisfied!" }\n'})}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:"ADVERSARIAL ATTACK SUCCESSFUL!\nFLAG: ikerlan{4dv3rs4r14l_y3ll0w_t0_gr33n}\n"})}),"\n",(0,s.jsx)(a.p,{children:"\xa1Y con esto conseguimos la flag del reto!"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{children:"ikerlan{4dv3rs4r14l_y3ll0w_t0_gr33n}\n"})})]})}function u(e={}){const{wrapper:a}={...(0,o.R)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}}}]);