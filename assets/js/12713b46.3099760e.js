"use strict";(globalThis.webpackChunkctf_writeups=globalThis.webpackChunkctf_writeups||[]).push([[619],{3378:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>m,frontMatter:()=>s,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"ikerlan-ctf/300/la-imagen-del-administrador/la-imagen-del-administrador","title":"La imagen del administrador (300)","description":"Alerta de Seguridad: Acceso No Autorizado","source":"@site/docs/ikerlan-ctf/300/la-imagen-del-administrador/la-imagen-del-administrador.mdx","sourceDirName":"ikerlan-ctf/300/la-imagen-del-administrador","slug":"/ikerlan-ctf/300/la-imagen-del-administrador/","permalink":"/docs/ikerlan-ctf/300/la-imagen-del-administrador/","draft":false,"unlisted":false,"editUrl":"https://github.com/KingJorjai/jorjai.net/tree/main/packages/create-docusaurus/templates/shared/docs/ikerlan-ctf/300/la-imagen-del-administrador/la-imagen-del-administrador.mdx","tags":[],"version":"current","frontMatter":{"title":"La imagen del administrador (300)"},"sidebar":"ctfWriteupsSidebar","previous":{"title":"La apariencia enga\xf1osa (300)","permalink":"/docs/ikerlan-ctf/300/la-apariencia-enga\xf1osa/"},"next":{"title":"El espectro oculto (400)","permalink":"/docs/ikerlan-ctf/400/el-espectro-oculto/"}}');var o=r(4848),i=r(8453);const s={title:"La imagen del administrador (300)"},t=void 0,d={},c=[{value:"An\xe1lisis inicial",id:"an\xe1lisis-inicial",level:2},{value:"Montaje y exploraci\xf3n de la imagen",id:"montaje-y-exploraci\xf3n-de-la-imagen",level:2},{value:"Obtenci\xf3n de la flag",id:"obtenci\xf3n-de-la-flag",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"Alerta de Seguridad: Acceso No Autorizado"}),"\n",(0,o.jsx)(n.p,{children:"Nuestro equipo de monitorizaci\xf3n ha detectado actividad sospechosa en uno de los servidores de control alojados en una Raspberry Pi. Creemos que un administrador no autorizado ha comprometido el sistema para extraer informaci\xf3n."}),"\n",(0,o.jsx)(n.p,{children:"Hemos conseguido capturar una imagen forense (.img) del disco duro justo antes de que el intruso pudiese borrar sus rastros. Tu misi\xf3n como analista es examinar esta imagen y recuperar cualquier evidencia dejada por el usuario maliciososo."}),"\n","\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://drive.google.com/file/d/1PxboB6AEcY0_x5T6FqzRkpewdWQJN_nB/view?usp=sharing",children:"Descargar la imagen forense"})}),"\n",(0,o.jsx)(n.h2,{id:"an\xe1lisis-inicial",children:"An\xe1lisis inicial"}),"\n",(0,o.jsxs)(n.p,{children:["Para analizar la imagen forense de la Raspberry Pi, podemos utilizar herramientas como ",(0,o.jsx)(n.code,{children:"fdisk"}),", ",(0,o.jsx)(n.code,{children:"mount"})," y ",(0,o.jsx)(n.code,{children:"binwalk"})," para explorar su contenido."]}),"\n",(0,o.jsx)(n.p,{children:"Primero, identificamos las particiones presentes en la imagen:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"fdisk -l rpi.img\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"Disk rpi.img: 1,83 GiB, 1967128576 bytes, 3842048 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x4c4e106f\n\nDevice     Boot  Start     End Sectors  Size Id Type\nrpi.img1          8192  532479  524288  256M  c W95 FAT32 (LBA)\nrpi.img2        532480 3842047 3309568  1,6G 83 Linux\n"})}),"\n",(0,o.jsx)(n.h2,{id:"montaje-y-exploraci\xf3n-de-la-imagen",children:"Montaje y exploraci\xf3n de la imagen"}),"\n",(0,o.jsx)(n.p,{children:"Observamos dos particiones: una FAT32 y otra Linux. Montamos la partici\xf3n Linux para examinar su contenido:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"mkdir /mnt/rpi\nsudo mount -o loop,offset=$((532480*512)) rpi.img /mnt/rpi\n"})}),"\n",(0,o.jsxs)(n.admonition,{type:"note",children:[(0,o.jsxs)(n.p,{children:["La opci\xf3n ",(0,o.jsx)(n.code,{children:"loop"})," permite montar una imagen de disco como si fuera un dispositivo de bloque, es decir, como un disco f\xedsico."]}),(0,o.jsxs)(n.p,{children:["La opci\xf3n ",(0,o.jsx)(n.code,{children:"offset"})," especifica el punto de inicio de la partici\xf3n dentro de la imagen, calculado en bytes. La hemos obtenido multiplicando el n\xfamero de sector de inicio de la partici\xf3n (532480) por el tama\xf1o del sector (512 bytes)."]})]}),"\n",(0,o.jsx)(n.p,{children:"Navegamos por el sistema de archivos montado para buscar archivos sospechosos o inusuales:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cd /mnt/rpi\nls -la\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ls",children:"total 76K\nlrwxrwxrwx  1 root root    7 may  3  2023 bin -> usr/bin\ndrwxr-xr-x  2 root root 4,0K may  3  2023 boot\ndrwxr-xr-x  4 root root 4,0K may  3  2023 dev\ndrwxr-xr-x 81 root root 4,0K may  3  2023 etc\ndrwxr-xr-x  4 root root 4,0K oct  6 17:20 home\nlrwxrwxrwx  1 root root    7 may  3  2023 lib -> usr/lib\ndrwx------  2 root root  16K may  3  2023 lost+found\ndrwxr-xr-x  2 root root 4,0K may  3  2023 media\ndrwxr-xr-x  2 root root 4,0K may  3  2023 mnt\ndrwxr-xr-x  2 root root 4,0K may  3  2023 opt\ndrwxr-xr-x  2 root root 4,0K dic 18  2022 proc\ndrwx------  2 root root 4,0K may  3  2023 root\ndrwxr-xr-x  4 root root 4,0K may  3  2023 run\nlrwxrwxrwx  1 root root    8 may  3  2023 sbin -> usr/sbin\ndrwxr-xr-x  2 root root 4,0K may  3  2023 srv\ndrwxr-xr-x  2 root root 4,0K dic 18  2022 sys\ndrwxrwxrwt  2 root root 4,0K may  3  2023 tmp\ndrwxr-xr-x 11 root root 4,0K may  3  2023 usr\ndrwxr-xr-x 11 root root 4,0K may  3  2023 var\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Exploramos el directorio ",(0,o.jsx)(n.code,{children:"/home"})," para buscar usuarios y archivos relevantes:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cd /mnt/rpi/home\ntree -a           # Usamos la opci\xf3n -a para listar archivos ocultos\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tree",children:".\n\u251c\u2500\u2500 admin\n\u2502\xa0\xa0 \u2514\u2500\u2500 .secret\n\u2502\xa0\xa0     \u2514\u2500\u2500 hidden.txt\n\u2514\u2500\u2500 pi\n    \u251c\u2500\u2500 .bash_logout\n    \u251c\u2500\u2500 .bashrc\n    \u2514\u2500\u2500 .profile\n\n4 directories, 4 files\n"})}),"\n",(0,o.jsx)(n.h2,{id:"obtenci\xf3n-de-la-flag",children:"Obtenci\xf3n de la flag"}),"\n",(0,o.jsxs)(n.p,{children:["Encontramos un archivo oculto ",(0,o.jsx)(n.code,{children:"hidden.txt"})," en el directorio del usuario ",(0,o.jsx)(n.code,{children:"admin"}),". Procedemos a leer su contenido:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cat /mnt/rpi/home/admin/.secret/hidden.txt\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"aWtlcmxhbnttMHVudDFuZ19pbTRnM3NfMXNfbTRnMWN9\n"})}),"\n",(0,o.jsx)(n.p,{children:"El contenido parece estar codificado en Base64. Decodificamos el texto y obtenemos la flag:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'echo "aWtlcmxhbnttMHVudDFuZ19pbTRnM3NfMXNfbTRnMWN9" | base64 --decode\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"ikerlan{m0unt1ng_im4g3s_1s_m4g1c}\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsx)(n.p,{children:"\xbfNunca se te habr\xeda ocurrido que pudiera ser Base64? Es muy habitual en CTFs usar esta codificaci\xf3n para ocultar informaci\xf3n de manera sencilla. La pr\xf3xima vez que te encuentres con un texto que no tiene sentido, pru\xe9balo."})})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>t});var a=r(6540);const o={},i=a.createContext(o);function s(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);