"use strict";(globalThis.webpackChunkctf_writeups=globalThis.webpackChunkctf_writeups||[]).push([[463],{1313:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>d,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"ikerlan-ctf/300/el-viaje-del-cifrado-perdido/el-viaje-del-cifrado-perdido","title":"El viaje del cifrado perdido (300)","description":"Descripci\xf3n del desaf\xedo","source":"@site/docs/ikerlan-ctf/300/el-viaje-del-cifrado-perdido/el-viaje-del-cifrado-perdido.mdx","sourceDirName":"ikerlan-ctf/300/el-viaje-del-cifrado-perdido","slug":"/ikerlan-ctf/300/el-viaje-del-cifrado-perdido/","permalink":"/docs/ikerlan-ctf/300/el-viaje-del-cifrado-perdido/","draft":false,"unlisted":false,"editUrl":"https://github.com/KingJorjai/jorjai.net/tree/main/packages/create-docusaurus/templates/shared/docs/ikerlan-ctf/300/el-viaje-del-cifrado-perdido/el-viaje-del-cifrado-perdido.mdx","tags":[],"version":"current","frontMatter":{"title":"El viaje del cifrado perdido (300)"},"sidebar":"ctfWriteupsSidebar","previous":{"title":"Un camino olvidado (200)","permalink":"/docs/ikerlan-ctf/200/un-camino-olvidado/"},"next":{"title":"La apariencia enga\xf1osa (300)","permalink":"/docs/ikerlan-ctf/300/la-apariencia-enga\xf1osa/"}}');var r=n(4848),o=n(8453);const d={title:"El viaje del cifrado perdido (300)"},l=void 0,s={},t=[{value:"Descripci\xf3n del desaf\xedo",id:"descripci\xf3n-del-desaf\xedo",level:2},{value:"An\xe1lisis inicial",id:"an\xe1lisis-inicial",level:2},{value:"Hip\xf3tesis sobre la vulnerabilidad",id:"hip\xf3tesis-sobre-la-vulnerabilidad",level:2},{value:"Explotaci\xf3n de la vulnerabilidad",id:"explotaci\xf3n-de-la-vulnerabilidad",level:2}];function c(e){const a={code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.h2,{id:"descripci\xf3n-del-desaf\xedo",children:"Descripci\xf3n del desaf\xedo"}),"\n",(0,r.jsx)(a.p,{children:"En un rinc\xf3n olvidado de la red, un antiguo servidor protege los secretos de un viajero legendario. La \xfanica manera de acceder a ellos es a trav\xe9s de un portal de login. Sin embargo, este portal es viejo y defectuoso, lo que te permite bypassar la seguridad si sabes c\xf3mo. Tu misi\xf3n es explotar la vulnerabilidad para obtener el cifrado final y la bandera."}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.img,{alt:"Una p\xe1gina de inicio de sesi\xf3n titulada &quot;La Cueva del Drag\xf3n&quot; con un campo para introducir una contrase\xf1a",src:n(5211).A+"",width:"935",height:"595"})}),"\n",(0,r.jsx)(a.h2,{id:"an\xe1lisis-inicial",children:"An\xe1lisis inicial"}),"\n",(0,r.jsx)(a.p,{children:"Siempre me gusta echar un vistazo al c\xf3digo fuente de las p\xe1ginas web, ya que a menudo contienen pistas ocultas o comentarios interesantes. En este caso no hay nada, pero s\xed que podemos ver que la p\xe1gina es bastante simple, con un formulario que env\xeda la contrase\xf1a al servidor."}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-html",metastring:'title="C\xf3digo fuente de la p\xe1gina de login"',children:'<!DOCTYPE html>\n<html lang="es">\n<head>\n    <meta charset="UTF-8">\n    <title>La Cueva del Drag\xf3n</title>\n    <style>\n        body { font-family: sans-serif; background-color: #f0f0f0; text-align: center; padding-top: 50px; }\n        .container { background-color: white; padding: 20px; border-radius: 8px; max-width: 400px; margin: auto; box-shadow: 0 0 10px rgba(0,0,0,0.1); }\n        input[type="text"] { width: 90%; padding: 10px; margin-top: 10px; border: 1px solid #ccc; border-radius: 4px; }\n        input[type="submit"] { background-color: #4CAF50; color: white; padding: 12px 20px; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px; }\n        .error { color: red; margin-top: 10px; }\n    </style>\n</head>\n<body>\n    <div class="container">\n        <h1>La Cueva del Drag\xf3n</h1>\n        <p>Un enorme drag\xf3n ha sellado su tesoro y solo el gran guerrero \'Aemond\' conoce la contrase\xf1a para abrirla.</p>\n        <p>\xbfSer\xe1s capaz de entrar?</p>\n        \n        <form action="/" method="post">\n            <input type="text" name="password" placeholder="Ingresa la contrase\xf1a secreta..." required>\n            <br>\n            <input type="submit" value="Entrar">\n        </form>\n        \n        \n            <p class="error">Contrase\xf1a incorrecta. \xa1Solo &#39;Aemond&#39; puede entrar!</p>\n        \n    </div>\n</body>\n</html>\n'})}),"\n",(0,r.jsx)(a.h2,{id:"hip\xf3tesis-sobre-la-vulnerabilidad",children:"Hip\xf3tesis sobre la vulnerabilidad"}),"\n",(0,r.jsx)(a.p,{children:"En este punto y con tan poca informaci\xf3n, lo \xfanico que se me ocurre es que el formulario de login podr\xeda ser vulnerable a inyecciones SQL. Si no hace ning\xfan tipo de sanitizaci\xf3n de la entrada, podr\xedamos intentar inyectar una consulta SQL para saltarnos la autenticaci\xf3n."}),"\n",(0,r.jsx)(a.p,{children:"Supongo que el backend utiliza una consulta SQL similar a esta para verificar la contrase\xf1a:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-sql",children:"SELECT * FROM users WHERE password = 'user_input';\n"})}),"\n",(0,r.jsx)(a.h2,{id:"explotaci\xf3n-de-la-vulnerabilidad",children:"Explotaci\xf3n de la vulnerabilidad"}),"\n",(0,r.jsxs)(a.p,{children:["Podr\xedamos intentar inyectar algo como ",(0,r.jsx)(a.code,{children:"' OR '1'='1"})," para que la consulta siempre devuelva verdadero:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-sql",children:"SELECT * FROM users WHERE password = '' OR '1'='1';\n"})}),"\n",(0,r.jsx)(a.p,{children:"Efectivamente, al introducir esa cadena en el campo de contrase\xf1a, logramos acceder al tesoro del drag\xf3n."}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.img,{alt:"Pantalla tras el inicio de sesi\xf3n",src:n(8561).A+"",width:"935",height:"477"})}),"\n",(0,r.jsx)(a.p,{children:"La flag es:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"ikerlan{sql_injection_is_magic}\n"})})]})}function p(e={}){const{wrapper:a}={...(0,o.R)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},5211:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/la-cueva-del-dragon-login-2fab687df18ab25552190eec196dc35c.png"},8453:(e,a,n)=>{n.d(a,{R:()=>d,x:()=>l});var i=n(6540);const r={},o=i.createContext(r);function d(e){const a=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function l(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(o.Provider,{value:a},e.children)}},8561:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/la-cueva-del-dragon-solved-02d726e90ffa0c3ffc523a3cb753a2a7.png"}}]);