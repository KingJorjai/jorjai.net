"use strict";(globalThis.webpackChunkctf_writeups=globalThis.webpackChunkctf_writeups||[]).push([[2251],{1469:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/landing-ab31863446207455c458cea3e396e0af.png"},4151:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/files/apariencia_enganosa-7f20145a31f55a77d5ea2bcf3d3acb3a.zip"},8453:(e,a,n)=>{n.d(a,{R:()=>s,x:()=>t});var i=n(6540);const r={},l=i.createContext(r);function s(e){const a=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function t(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(l.Provider,{value:a},e.children)}},9085:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"ikerlan-ctf/300/la-apariencia-enga\xf1osa/la-apariencia-enga\xf1osa","title":"La apariencia enga\xf1osa (300)","description":"Hay un sistema de gesti\xf3n de archivos en el servidor. Te permite ver el contenido de los archivos de una carpeta. Parece una herramienta simple, pero \xbfqu\xe9 pasa si el sistema conf\xeda demasiado en ti? Descubre c\xf3mo leer un archivo que no deber\xedas poder ver y encuentra la flag oculta en alg\xfan lugar del sistema.","source":"@site/docs/ikerlan-ctf/300/la-apariencia-enga\xf1osa/la-apariencia-enga\xf1osa.mdx","sourceDirName":"ikerlan-ctf/300/la-apariencia-enga\xf1osa","slug":"/ikerlan-ctf/300/la-apariencia-enga\xf1osa/","permalink":"/docs/ikerlan-ctf/300/la-apariencia-enga\xf1osa/","draft":false,"unlisted":false,"editUrl":"https://github.com/KingJorjai/jorjai.net/tree/main/packages/create-docusaurus/templates/shared/docs/ikerlan-ctf/300/la-apariencia-enga\xf1osa/la-apariencia-enga\xf1osa.mdx","tags":[],"version":"current","frontMatter":{"title":"La apariencia enga\xf1osa (300)"},"sidebar":"ctfWriteupsSidebar","previous":{"title":"El viaje del cifrado perdido (300)","permalink":"/docs/ikerlan-ctf/300/el-viaje-del-cifrado-perdido/"},"next":{"title":"La imagen del administrador (300)","permalink":"/docs/ikerlan-ctf/300/la-imagen-del-administrador/"}}');var r=n(4848),l=n(8453);const s={title:"La apariencia enga\xf1osa (300)"},t=void 0,c={},o=[{value:"An\xe1lisis inicial",id:"an\xe1lisis-inicial",level:2},{value:"Explotaci\xf3n",id:"explotaci\xf3n",level:2}];function d(e){const a={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.p,{children:"Hay un sistema de gesti\xf3n de archivos en el servidor. Te permite ver el contenido de los archivos de una carpeta. Parece una herramienta simple, pero \xbfqu\xe9 pasa si el sistema conf\xeda demasiado en ti? Descubre c\xf3mo leer un archivo que no deber\xedas poder ver y encuentra la flag oculta en alg\xfan lugar del sistema."}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(4151).A+"",children:"Descargar contenedor Docker del desaf\xedo"})}),"\n",(0,r.jsx)(a.h2,{id:"an\xe1lisis-inicial",children:"An\xe1lisis inicial"}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.img,{alt:"P\xe1gina principal",src:n(1469).A+"",width:"1920",height:"1134"})}),"\n",(0,r.jsx)(a.p,{children:"En la p\xe1gina principal, no tenemos nada de informaci\xf3n sobre la flag. Solo una pantalla de bienvenida. Por suerte, para este reto contamos con el c\xf3digo fuente del servidor web."}),"\n",(0,r.jsxs)(a.p,{children:["Echando un vistazo a la estructura de archivos del contenedor, vemos que hay un fichero ",(0,r.jsx)(a.code,{children:"index.php"})," en la carpeta ",(0,r.jsx)(a.code,{children:"html"})," que es el que se sirve al usuario. Tambi\xe9n hay un fichero ",(0,r.jsx)(a.code,{children:"flag.txt"})," que probablemente contenga la flag del reto."]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-tree",metastring:'title="$ tree"',children:".\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 html\n    \u251c\u2500\u2500 flag.txt\n    \u251c\u2500\u2500 index.html\n    \u251c\u2500\u2500 index.php\n    \u2514\u2500\u2500 style.css\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Vamos a ver el contenido del fichero ",(0,r.jsx)(a.code,{children:"index.php"})," para entender c\xf3mo funciona la aplicaci\xf3n."]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-php",metastring:'title="index.php"',children:"<?php\n\n$page = $_GET['page'] ?? 'index.html';\n\nif (file_exists($page)) {\n    include($page);\n} else {\n    echo \"<h1>404 Not Found</h1><p>La p\xe1gina no existe.</p>\";\n}\n\n?>\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Se trata de un c\xf3digo muy simple. La aplicaci\xf3n obtiene el par\xe1metro ",(0,r.jsx)(a.code,{children:"page"})," de la URL y lo utiliza para incluir un archivo en la respuesta. Si el archivo no existe, muestra un mensaje de error 404."]}),"\n",(0,r.jsx)(a.h2,{id:"explotaci\xf3n",children:"Explotaci\xf3n"}),"\n",(0,r.jsxs)(a.p,{children:["El problema aqu\xed es que la aplicaci\xf3n no valida el valor del par\xe1metro ",(0,r.jsx)(a.code,{children:"page"}),". Esto significa que podemos utilizar rutas relativas para acceder a archivos dentro del directorio del servidor. Vamos a intentar acceder al archivo ",(0,r.jsx)(a.code,{children:"flag.txt"})," utilizando la siguiente URL:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"http://localhost:80/?page=flag.txt\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Tal y como esper\xe1bamos, la aplicaci\xf3n incluye el contenido de ",(0,r.jsx)(a.code,{children:"flag.txt"})," en la respuesta:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"ikerlan{lfilfilfilfilfilfi}\n"})}),"\n",(0,r.jsx)(a.admonition,{type:"note",children:(0,r.jsx)(a.p,{children:"LFI son las siglas de Local File Inclusion, una vulnerabilidad que permite a un atacante incluir archivos locales en el servidor web."})})]})}function p(e={}){const{wrapper:a}={...(0,l.R)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);