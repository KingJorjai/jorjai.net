"use strict";(globalThis.webpackChunkctf_writeups=globalThis.webpackChunkctf_writeups||[]).push([[3924],{930:(e,s,t)=>{t.d(s,{A:()=>a});const a=t.p+"assets/images/temperature_log-1256adc9b85c95fdc62c8da66c325faf.png"},7152:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"ikerlan-ctf/200/el-termometro-saboteado/el-termometro-saboteado","title":"El term\xf3metro saboteado (200)","description":"Descripci\xf3n del desaf\xedo","source":"@site/docs/ikerlan-ctf/200/el-termometro-saboteado/el-termometro-saboteado.mdx","sourceDirName":"ikerlan-ctf/200/el-termometro-saboteado","slug":"/ikerlan-ctf/200/el-termometro-saboteado/","permalink":"/docs/ikerlan-ctf/200/el-termometro-saboteado/","draft":false,"unlisted":false,"editUrl":"https://github.com/KingJorjai/jorjai.net/tree/main/packages/create-docusaurus/templates/shared/docs/ikerlan-ctf/200/el-termometro-saboteado/el-termometro-saboteado.mdx","tags":[],"version":"current","frontMatter":{"title":"El term\xf3metro saboteado (200)"},"sidebar":"ctfWriteupsSidebar","previous":{"title":"El mensaje de la cueva (200)","permalink":"/docs/ikerlan-ctf/200/el-mensaje-de-la-cueva/"},"next":{"title":"Un camino olvidado (200)","permalink":"/docs/ikerlan-ctf/200/un-camino-olvidado/"}}');var n=t(4848),r=t(8453);const o={title:"El term\xf3metro saboteado (200)"},i=void 0,c={},d=[{value:"Descripci\xf3n del desaf\xedo",id:"descripci\xf3n-del-desaf\xedo",level:2},{value:"An\xe1lisis inicial",id:"an\xe1lisis-inicial",level:2},{value:"Extracci\xf3n de temperaturas &quot;imposibles&quot;",id:"extracci\xf3n-de-temperaturas-imposibles",level:2}];function l(e){const s={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h2,{id:"descripci\xf3n-del-desaf\xedo",children:"Descripci\xf3n del desaf\xedo"}),"\n",(0,n.jsx)(s.p,{children:"El laboratorio de IoT de la universidad tiene un sistema de monitorizaci\xf3n de temperatura con varios Arduinos distribuidos por el edificio. Cada Arduino lee un sensor DHT22 y env\xeda los datos cada minuto a un servidor central. Esta ma\xf1ana, el t\xe9cnico de sistemas not\xf3 algo extra\xf1o: uno de los sensores (Sensor_Lab_B3) est\xe1 reportando temperaturas imposibles de forma intermitente:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"[09:00] Sensor_Lab_B3: 22.4\xb0C \u2713 Normal"}),"\n",(0,n.jsx)(s.li,{children:"[09:01] Sensor_Lab_B3: 23.1\xb0C \u2713 Normal"}),"\n",(0,n.jsx)(s.li,{children:"[09:02] Sensor_Lab_B3: 104.0\xb0C \xa1Imposible!"}),"\n",(0,n.jsx)(s.li,{children:"[09:03] Sensor_Lab_B3: 22.8\xb0C \u2713 Normal"}),"\n",(0,n.jsx)(s.li,{children:"[09:04] Sensor_Lab_B3: 52.0\xb0C \xa1Imposible!"}),"\n",(0,n.jsx)(s.li,{children:"[09:05] Sensor_Lab_B3: 23.2\xb0C \u2713 Normal"}),"\n",(0,n.jsx)(s.li,{children:"[09:06] Sensor_Lab_B3: 99.0\xb0C \xa1Imposible!"}),"\n",(0,n.jsx)(s.li,{children:"..."}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:'Al revisar el Arduino f\xedsicamente, todo parece normal. El sensor funciona bien. Pero alguien modific\xf3 el c\xf3digo para que ocasionalmente reporte "temperaturas falsas" que en realidad son... un mensaje secreto. Tu misi\xf3n: Analizar el log de temperaturas de las \xfaltimas 24 horas y descubrir qu\xe9 mensaje est\xe1 escondido en esas lecturas "imposibles".'}),"\n",(0,n.jsx)(s.p,{children:"Formato de la flag: ikerlan{mensaje_oculto}"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(8828).A+"",children:"Descargar log de temperaturas"})}),"\n",(0,n.jsx)(s.h2,{id:"an\xe1lisis-inicial",children:"An\xe1lisis inicial"}),"\n",(0,n.jsx)(s.p,{children:"Lo primero que hago es descargar el archivo CSV con el log de temperaturas y abrirlo en un editor de texto para echar un vistazo r\xe1pido a su contenido."}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"Tabla de temperaturas",src:t(930).A+"",width:"1843",height:"1054"})}),"\n",(0,n.jsx)(s.p,{children:'Echando un vistazo r\xe1pido, los valores de las temperaturas "imposibles" parecen estar en un rango entre 50 y 150 grados Celsius. Sospecho que estos valores podr\xedan estar codificando caracteres ASCII, ya que los caracteres imprimibles en ASCII van desde el 32 (espacio) hasta el 126 (~).'}),"\n",(0,n.jsx)(s.h2,{id:"extracci\xf3n-de-temperaturas-imposibles",children:'Extracci\xf3n de temperaturas "imposibles"'}),"\n",(0,n.jsx)(s.p,{children:'Para extraer las temperaturas "imposibles" del CSV, escribo un peque\xf1o script en Python que lea el archivo, filtre las temperaturas marcadas como "ANOMALY" y convierta esos valores a caracteres ASCII.'}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",metastring:'showLineNumbers="true" title="extract_message.py"',children:"import csv\n\n# Ruta del CSV\ncsv_path = \"temperature_log.csv\"\n\nmensaje = \"\"\n\nwith open(csv_path, newline='', encoding='utf-8') as csvfile:\n    lector = csv.DictReader(csvfile, delimiter=',')\n    for fila in lector:\n        if fila['status'].strip().upper() == \"ANOMALY\":\n            # Cambiar coma por punto y convertir a float\n            temperatura = float(fila['temperature'].replace(',', '.'))\n            # Convertir a entero y luego a car\xe1cter ASCII\n            mensaje += chr(int(temperatura))\n\nprint(\"Mensaje oculto:\", mensaje)\n"})}),"\n",(0,n.jsx)(s.p,{children:"Al ejecutar este script, obtengo el siguiente mensaje oculto:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"$ python extract_message.py\nMensaje oculto: h4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_stud3ntsh4ck3d_by_st\n"})}),"\n",(0,n.jsxs)(s.p,{children:["El mensaje se repite varias veces, pero la parte relevante es: ",(0,n.jsx)(s.code,{children:"h4ck3d_by_stud3nts"}),". Aplicando el formato de la flag, la respuesta final es:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"ikerlan{h4ck3d_by_stud3nts}\n"})})]})}function u(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>o,x:()=>i});var a=t(6540);const n={},r=a.createContext(n);function o(e){const s=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),a.createElement(r.Provider,{value:s},e.children)}},8828:(e,s,t)=>{t.d(s,{A:()=>a});const a=t.p+"assets/files/temperature_log-051ab1312beb6b2e83d1976faaf046a2.csv"}}]);