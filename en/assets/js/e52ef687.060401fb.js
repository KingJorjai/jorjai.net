"use strict";(globalThis.webpackChunkctf_writeups=globalThis.webpackChunkctf_writeups||[]).push([[6609],{1468:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"ikerlan-ctf/100/gpio-binary-password/gpio-binary-password","title":"GPIO binary password (100)","description":"Descripci\xf3n del desaf\xedo","source":"@site/docs/ikerlan-ctf/100/gpio-binary-password/gpio-binary-password.mdx","sourceDirName":"ikerlan-ctf/100/gpio-binary-password","slug":"/ikerlan-ctf/100/gpio-binary-password/","permalink":"/en/docs/ikerlan-ctf/100/gpio-binary-password/","draft":false,"unlisted":false,"editUrl":"https://github.com/KingJorjai/jorjai.net/tree/main/packages/create-docusaurus/templates/shared/docs/ikerlan-ctf/100/gpio-binary-password/gpio-binary-password.mdx","tags":[],"version":"current","frontMatter":{"title":"GPIO binary password (100)"},"sidebar":"ctfWriteupsSidebar","previous":{"title":"Introduction","permalink":"/en/docs/intro"},"next":{"title":"Ojo de lince (100)","permalink":"/en/docs/ikerlan-ctf/100/ojo-de-lince/"}}');var a=i(4848),s=i(8453);const o={title:"GPIO binary password (100)"},t=void 0,c={},d=[{value:"Descripci\xf3n del desaf\xedo",id:"descripci\xf3n-del-desaf\xedo",level:2},{value:"An\xe1lisis inicial",id:"an\xe1lisis-inicial",level:2},{value:"Extracci\xf3n de la contrase\xf1a",id:"extracci\xf3n-de-la-contrase\xf1a",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"descripci\xf3n-del-desaf\xedo",children:"Descripci\xf3n del desaf\xedo"}),"\n",(0,a.jsx)(n.p,{children:"Has encontrado un Arduino olvidado en el aula de rob\xf3tica. Est\xe1 encendido y todos sus pines digitales est\xe1n en diferentes estados (HIGH o LOW). Un post-it pegado al Arduino dice:"}),"\n",(0,a.jsx)(n.p,{children:'"Si lees correctamente el estado de los pines, descubrir\xe1s la contrase\xf1a del laboratorio.'}),"\n",(0,a.jsx)(n.p,{children:"Pines D2-D9 contienen el secreto. HIGH = 1, LOW = 0"}),"\n",(0,a.jsx)(n.p,{children:'La flag tiene el siguiente formato: ikerlan{contrase\xf1a}"'}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(5514).A+"",children:"Diagrama del Arduino"})}),"\n",(0,a.jsx)(n.h2,{id:"an\xe1lisis-inicial",children:"An\xe1lisis inicial"}),"\n",(0,a.jsx)(n.p,{children:"Al observar el diagrama del Arduino, podemos ver que los pines digitales D2 a D9 est\xe1n en diferentes estados. Seg\xfan la pista, debemos interpretar HIGH como 1 y LOW como 0 para formar un byte binario. Por ejemplo, el car\xe1cter uno se representa de la siguiente manera:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"CHARACTER #1:\n\n        Arduino UNO\n    +----------------+\n    |                |\n    | D2 \u25cf HIGH  5V |\n    | D3 \u25cf HIGH  5V |\n    | D4 \u25cf HIGH  5V |\n    | D5 \u25cb LOW   0V |\n    | D6 \u25cf HIGH  5V |\n    | D7 \u25cb LOW   0V |\n    | D8 \u25cf HIGH  5V |\n    | D9 \u25cb LOW   0V |\n    |                |\n    +----------------+\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Podemos pensar que este byte codifica un car\xe1cter en ASCII. Si leemos los pines de D2 a D9, obtenemos el byte ",(0,a.jsx)(n.code,{children:"11101010"}),". Usando una herramienta como ",(0,a.jsx)(n.a,{href:"https://gchq.github.io/CyberChef/#recipe=From_Binary('None',8)&input=MTExMDEwMTA&oeol=FF",children:"CyberChef"}),", podemos convertir este byte binario a su representaci\xf3n ASCII, que en este caso es el car\xe1cter '\xea'."]}),"\n",(0,a.jsxs)(n.p,{children:["Me parece que es una letra extra\xf1a para la flag, es posible que los bytes est\xe9n en orden inverso (little-endian). Si invertimos el byte a ",(0,a.jsx)(n.code,{children:"01010111"}),", obtenemos el car\xe1cter 'W', que es m\xe1s probable que forme parte de la flag."]}),"\n",(0,a.jsx)(n.h2,{id:"extracci\xf3n-de-la-contrase\xf1a",children:"Extracci\xf3n de la contrase\xf1a"}),"\n",(0,a.jsx)(n.p,{children:"Podemos ir copiando los estados de los pines y traduci\xe9ndolos a caracteres ASCII uno por uno (solo son 13 caracteres). Otra opci\xf3n es usar un script en Python para automatizar el proceso:"}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsx)(n.p,{children:"Como podr\xe9is imaginar, prefer\xed traducir uno a uno los estados a tener que escribir el script, pero aqu\xed lo ten\xe9is por si quer\xe9is usarlo."})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",metastring:'title="decode_arduino.py"',children:"import re\n\ndef decode_arduino_file(filename):\n    with open(filename, 'r', encoding='utf-8') as f:\n        content = f.read()\n\n    # dividir en bloques CHARACTER\n    characters = re.split(r'-{20,}', content)\n    result = \"\"\n\n    for block in characters:\n        if \"D2\" not in block:\n            continue\n\n        # extraer l\xedneas D2..D9\n        bits = []\n        for pin in range(2, 10):\n            match = re.search(rf\"D{pin}\\s+[\u25cf\u25cb]\", block)\n            if not match:\n                continue\n            symbol = match.group(0)[-1]\n            bits.append('1' if symbol == '\u25cf' else '0')\n\n        if len(bits) != 8:\n            continue\n\n        # D2 = LSB \u2192 bits[0] = bit0 ... bits[7] = bit7\n        byte_val = int(''.join(bits[::-1]), 2)  # invertimos porque bits[0]=LSB\n        result += chr(byte_val)\n\n    return result\n\n\nif __name__ == \"__main__\":\n    path = \"visual_diagram.txt\"  # nombre del archivo de entrada\n    message = decode_arduino_file(path)\n    print(\"Mensaje decodificado:\")\n    print(message)\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Al ejecutar este script obtenemos la flag parcial: ",(0,a.jsx)(n.code,{children:"Who_Said_GP10"}),". A\xf1adiendo el prefijo y sufijo, la flag completa es:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"ikerlan{Who_Said_GP10}\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},5514:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/files/visual_diagram-da2f78ea240cf0b9ce2e23a0944ebe1f.txt"},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>t});var r=i(6540);const a={},s=r.createContext(a);function o(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);